<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interviews Calendar</title>

  <!-- FullCalendar CSS -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css" rel="stylesheet">

  <!-- Inline CSS -->
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, #f395b3, #ffffff);
      color: #66142c;
      min-height: 100vh;
    }

    .container {
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: #ffffff;
      border-radius: 15px;
      box-shadow: 0px 8px 20px rgba(0, 0, 0, 0.15);
    }

    h1 {
      font-size: 2.5rem;
      font-weight: bold;
      color: #921b2f;
      margin-bottom: 20px;
      text-align: center;
    }

    #calendar {
      background: #ffffff;
      border-radius: 15px;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
      padding: 20px;
    }
    .btn-primary, .btn-success {
      background: linear-gradient(135deg, #f395b3, #921b2f);
      border: none;
      padding: 10px 20px;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: bold;
      color: #ffffff;
      text-transform: uppercase;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .btn-primary:hover, .btn-success:hover {
      background: linear-gradient(135deg, #921b2f, #66142c);
      transform: translateY(-3px);
    }
    .fc-toolbar-chunk .fc-button {
    background: linear-gradient(135deg, #f395b3, #921b2f); /* Gradijent za dugmad */
    border: none;
    color: white;
    padding: 10px;
    border-radius: 5px;
    font-weight: bold;
    text-transform: uppercase;
    transition: all 0.3s ease;
  }

  .fc-toolbar-chunk .fc-button:hover {
    background: linear-gradient(135deg, #921b2f, #66142c); /* Hover efekat */
    transform: scale(1.05);
  }

  .fc-daygrid-day.has-event {
  background: linear-gradient(135deg, #f395b3, #ffe6e6);
  border-radius: 5px;
}

.fc-daygrid-day.has-event:hover {
  background: linear-gradient(135deg, #921b2f, #f395b3);
  cursor: pointer;
  transform: scale(1.03);
}



  #eventPopup {
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translate(-50%, -60%);
  }
  to {
    opacity: 1;
    transform: translate(-50%, -50%);
  }
}


  </style>
</head>
<body>
  <div class="container">
    <h1>Interviews Calendar</h1>
    <a href="/admin-dashboard" class="btn btn-primary w-100">Back to Dashboard</a>
    <div id="calendar"></div>
  </div>

  <div id="eventPopup" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2); padding: 20px; border-radius: 10px; z-index: 1000; max-width: 400px; width: 90%;">
    <h3 id="popupTitle" style="margin-top: 0; color: #921b2f;"></h3>
    <p><strong>Date:</strong> <span id="popupDate"></span></p>
    <p><strong>Location:</strong> <span id="popupLocation"></span></p>
    <p><strong>Notes:</strong> <span id="popupNotes"></span></p>
    <button id="deleteEvent" class="btn btn-primary" style="margin-right: 10px;">Delete</button>
    <button id="closePopup" class="btn btn-primary">Close</button>
  </div>
  

  <!-- FullCalendar JS -->
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
        const calendarEl = document.getElementById('calendar');
        const calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth', // Početni prikaz
            events: '/interviews/api', // Ruta za dohvaćanje intervjua
            editable: true,
            selectable: true,
            headerToolbar: {
                left: 'prev,next today', // Zadržavamo strelice i "Today"
                center: 'title', // Naslov kalendara
                right: '' // Uklonjen izbor prikaza (month, week, day)
            },
            eventDidMount: function (info) {
                const dateString = info.event.start.toISOString().split('T')[0];
                const dayCell = document.querySelector(`[data-date="${dateString}"]`);
                if (dayCell) {
                    dayCell.classList.add('has-event'); // Dodaj klasu za osenčenje
                }
            },
            eventClick: function (info) {
                const popup = document.getElementById('eventPopup');
                popup.style.display = 'block';
    
                document.getElementById('popupTitle').innerText = info.event.title;
                document.getElementById('popupDate').innerText = new Date(info.event.start).toLocaleString();
                document.getElementById('popupLocation').innerText = info.event.extendedProps.location || 'N/A';
                document.getElementById('popupNotes').innerText = info.event.extendedProps.notes || 'N/A';
    
                const deleteBtn = document.getElementById('deleteEvent');
                deleteBtn.onclick = async function () {
                    if (confirm('Are you sure you want to delete this interview?')) {
                        const response = await fetch(`/interviews/${info.event.id}`, {
                            method: 'DELETE',
                        });
    
                        if (response.ok) {
                            alert('Interview deleted successfully.');
                            info.event.remove();
                            popup.style.display = 'none';
                        } else {
                            alert('Error deleting interview.');
                        }
                    }
                };
            }
        });
    
        calendar.render();
    
        document.getElementById('closePopup').onclick = function () {
            document.getElementById('eventPopup').style.display = 'none';
        };
    });
    </script>
</body>
</html>
